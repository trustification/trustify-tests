Feature: Vulnerability Explorer - View Vulnerability details
    Background: Authentication
        Given User is authenticated

    # Search for vulnerability
    Scenario: Search for a vulnerability using the general search bar
        When User searches for "<vulnerabilityID>" in the general search bar
        Then The vulnerability "<vulnerabilityID>" shows in the results

        Examples:
            | vulnerabilityID |
            | CVE-2023-1664   |

    Scenario: Search for a vulnerability using the dedicated search bar
        When User searches for "<vulnerabilityID>" in the dedicated search bar
        Then The vulnerability "<vulnerabilityID>" shows in the results

        Examples:
            | vulnerabilityID |
            | CVE-2023-1664   |

    # Vulnerability Explorer
    Scenario: Display an overview of a vulnerability
        Given User visits Vulnerability details Page of "<vulnerabilityID>"
        Then The page title is "<vulnerabilityID>"
        Then The severity is "<severityDescription>" and the CVSS score is "<severityScore>"
        Then The description begins with "<descriptionBeginsWith>"
        Then The Reserved date is "<dateReserved>", the Published date is "<datePublished>" and Last modified date is "<dateLastModified>"

        Examples:
            | vulnerabilityID | severityDescription | severityScore | descriptionBeginsWith         | dateReserved | datePublished | dateLastModified |
            # | CVE-2023-1664   | Medium              | 6.5           | A flaw was found in Keycloak. | Mar 27, 2023 | May 26, 2023  | Jan 15, 2025     |
            | CVE-2024-26308 | Unknown              |               | Apache Commons Compress | Feb 17, 2024 | Feb 19, 2024  | Aug 02, 2024     |

    # Related products / SBOMs
    Scenario Outline: View related SBOMs
        Given User visits Vulnerability details Page of "<vulnerabilityID>"
        When Tab "Related SBOMs" is visible
        Then The page title is "<vulnerabilityID>"

        Then The SBOMs table is sorted by "Name"
        Then The SBOMs table total results is 1
        Then The "Name" column of the SBOM table contains "<sbomName>"

        Examples:
            | vulnerabilityID | sbomName    |
            | CVE-2023-1664   | quarkus-bom |

    # Related advisories
    Scenario Outline: View related Advisories
        Given User visits Vulnerability details Page of "<vulnerabilityID>"
        Then The page title is "<vulnerabilityID>"

        Examples:
            | vulnerabilityID |
            | CVE-2023-1664   |
